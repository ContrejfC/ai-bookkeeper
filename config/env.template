# ============================================================================
# AI Bookkeeper - Environment Variables Template
# ============================================================================
# Copy this to .env for local development
# For production (Render), set these in Dashboard → Environment
# ============================================================================

# ===== Core Application =====
ENV=production
BASE_URL=https://ai-bookkeeper.onrender.com
PUBLIC_BASE_URL=https://ai-bookkeeper.onrender.com
JWT_SECRET=change_me_long_random_string_min_32_chars
CSRF_SECRET=another_long_random_string_min_32_chars
DATABASE_URL=postgresql+psycopg2://USER:PASSWORD@HOST:PORT/DB
LOG_LEVEL=INFO
CORS_ALLOWED_ORIGINS=*
AUTH_MODE=production  # or "dev" for development

# ===== Stripe Billing =====
# Start with TEST mode, switch to LIVE when ready
# See: docs/STRIPE_LIVE_SWITCH.md

# TEST Mode (default for development/staging)
STRIPE_SECRET_KEY=sk_test_YOUR_KEY_HERE
STRIPE_PUBLISHABLE_KEY=pk_test_YOUR_KEY_HERE
STRIPE_WEBHOOK_SECRET=whsec_test_YOUR_SECRET_HERE

# LIVE Mode (production - replace values above with these when ready)
# STRIPE_SECRET_KEY=sk_live_YOUR_KEY_HERE
# STRIPE_PUBLISHABLE_KEY=pk_live_YOUR_KEY_HERE
# STRIPE_WEBHOOK_SECRET=whsec_YOUR_SECRET_HERE

# Product/Price IDs (created by scripts/stripe_bootstrap.py)
# Run script with TEST key first, then with LIVE key for production
STRIPE_PRICE_STARTER=price_xxxxxxxxxxxxxxxxxxxxxx
STRIPE_PRICE_PRO=price_xxxxxxxxxxxxxxxxxxxxxx
STRIPE_PRICE_FIRM=price_xxxxxxxxxxxxxxxxxxxxxx

# Optional: Referral coupon
STRIPE_REFERRAL_COUPON_ID=

# Billing return URL (after checkout/portal)
BILLING_RETURN_URL=${BASE_URL}/dashboard
APP_URL=${BASE_URL}

# ===== QuickBooks Online =====
# Start with Sandbox, switch to Production when ready
# See: docs/QBO_PROD_SWITCH.md

# OAuth Credentials (get from developer.intuit.com)
QBO_CLIENT_ID=YOUR_CLIENT_ID_HERE
QBO_CLIENT_SECRET=YOUR_CLIENT_SECRET_HERE

# Redirect URI (must match Intuit app settings exactly)
QBO_REDIRECT_URI=${BASE_URL}/api/auth/qbo/callback

# Scopes (required for journal entry posting)
QBO_SCOPES=com.intuit.quickbooks.accounting

# API Base URLs
# Sandbox (default):
QBO_BASE=https://sandbox-quickbooks.api.intuit.com
QBO_AUTH_BASE=https://appcenter.intuit.com/connect/oauth2
QBO_ENVIRONMENT=sandbox

# Production (uncomment when switching to LIVE):
# QBO_BASE=https://quickbooks.api.intuit.com
# QBO_AUTH_BASE=https://appcenter.intuit.com/connect/oauth2
# QBO_ENVIRONMENT=production

# ===== Billing Limits & Free Tier =====
FREE_PROPOSE_CAP_DAILY=50
AUTOPOST=false
AUTOPOST_ENABLED=false
GATING_THRESHOLD=0.90

# ===== Privacy & Training Data (Plan B) =====
# See: GA_READINESS_STATUS.md
ENABLE_LABELS=true
LABEL_SALT_ROUNDS=12

# ===== Observability & Monitoring =====
# See: docs/OBS_ALERTS.md

# Sentry (optional, for error tracking)
SENTRY_DSN=

# External logging (optional)
LOG_DRAIN_URL=
LOG_DRAIN_API_KEY=

# ===== Legacy/Optional Services =====
# Redis (for background jobs, if implemented)
REDIS_URL=redis://localhost:6379/0

# Password reset (if email system added)
PASSWORD_RESET_SECRET=another_secret_key

# OCR provider (for receipt processing)
OCR_PROVIDER=tesseract

# UI flags
UI_ASSESSMENT=1

# GitHub/Render integrations (for compliance snapshots)
GITHUB_ORG=
GITHUB_TOKEN=
RENDER_API_KEY=

# ============================================================================
# RENDER DEPLOYMENT NOTES
# ============================================================================
# 
# In Render Dashboard:
# 1. Go to your service → Environment tab
# 2. Click "Add Environment Variable"
# 3. Add each required variable above
# 4. For DATABASE_URL: Render auto-provides this when you link PostgreSQL
# 5. After adding all, click "Save Changes" → auto-redeploys
#
# Required Variables (minimum to run):
#   - DATABASE_URL (auto-provided by Render if PostgreSQL linked)
#   - JWT_SECRET (generate: openssl rand -hex 32)
#   - CSRF_SECRET (generate: openssl rand -hex 32)
#   - BASE_URL, PUBLIC_BASE_URL (your Render URL)
#
# Optional for Full Features:
#   - Stripe keys (for billing)
#   - QBO credentials (for QuickBooks integration)
#   - Sentry DSN (for error monitoring)
#
# ============================================================================

# ============================================================================
# QUICK START GUIDES
# ============================================================================
#
# Generate Secrets:
#   openssl rand -hex 32  # For JWT_SECRET and CSRF_SECRET
#
# Stripe Bootstrap (TEST mode):
#   STRIPE_SECRET_KEY=sk_test_xxx python scripts/stripe_bootstrap.py
#   # Outputs: STRIPE_PRICE_STARTER, STRIPE_PRICE_PRO, STRIPE_PRICE_FIRM
#
# Stripe LIVE Mode:
#   STRIPE_SECRET_KEY=sk_live_xxx python scripts/stripe_bootstrap.py
#   # Then update all STRIPE_* variables in Render
#   # See: docs/STRIPE_LIVE_SWITCH.md
#
# QBO Production:
#   # Create production app at developer.intuit.com
#   # Update QBO_CLIENT_ID, QBO_CLIENT_SECRET
#   # Change QBO_BASE to production URL
#   # See: docs/QBO_PROD_SWITCH.md
#
# Verification (run on Render or after setting env vars):
#   python scripts/verify_prod_env.py
#   python scripts/check_qbo_env.py
#   python scripts/verify_stripe_webhook.py
#
# Smoke Test:
#   ./ops/smoke_live.sh \
#     --base-url https://ai-bookkeeper.onrender.com \
#     --api-key ak_live_xxx \
#     --spec-version v1.0
#
# ============================================================================


