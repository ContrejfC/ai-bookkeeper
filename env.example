# ============================================================================
# AI Bookkeeper - Environment Variables
# ============================================================================
# Copy this file to .env and fill in the values

# ============================================================================
# Backend (FastAPI)
# ============================================================================

# Database
DATABASE_URL=sqlite:///./aibookkeeper.db
# For PostgreSQL: postgresql://user:password@localhost:5432/aibookkeeper

# Stripe Configuration (Get from https://dashboard.stripe.com/apikeys)
STRIPE_SECRET_KEY=sk_live_XXXXX  # Use sk_test_XXXXX for testing
STRIPE_WEBHOOK_SECRET=whsec_XXXXX

# Stripe Price IDs (Create products/prices in Stripe Dashboard)
STRIPE_PRICE_STARTER_MONTHLY=price_XXXXX
STRIPE_PRICE_STARTER_ANNUAL=price_XXXXX
STRIPE_PRICE_TEAM_MONTHLY=price_XXXXX
STRIPE_PRICE_TEAM_ANNUAL=price_XXXXX
STRIPE_PRICE_FIRM_MONTHLY=price_XXXXX
STRIPE_PRICE_FIRM_ANNUAL=price_XXXXX
STRIPE_PRICE_PILOT_MONTHLY=price_XXXXX

# Stripe Metered Overage Price IDs
STRIPE_PRICE_OVERAGE_STARTER=price_XXXXX
STRIPE_PRICE_OVERAGE_TEAM=price_XXXXX
STRIPE_PRICE_OVERAGE_FIRM=price_XXXXX
STRIPE_PRICE_OVERAGE_ENTERPRISE=price_XXXXX

# Stripe Add-on Price IDs
STRIPE_PRICE_ADDON_ENTITY_STARTER=price_XXXXX
STRIPE_PRICE_ADDON_ENTITY_FIRM=price_XXXXX
STRIPE_PRICE_ADDON_SSO=price_XXXXX
STRIPE_PRICE_ADDON_WHITELABEL=price_XXXXX
STRIPE_PRICE_ADDON_RETENTION=price_XXXXX
STRIPE_PRICE_ADDON_PRIORITY_SUPPORT=price_XXXXX

# CORS Configuration
ALLOWED_ORIGINS=https://app.ai-bookkeeper.app,https://ai-bookkeeper-web.onrender.com

# JWT Secret
SECRET_KEY=your-secret-key-here-change-in-production

# OpenAI API (for AI categorization)
OPENAI_API_KEY=sk-XXXXX
OPENAI_MODEL=gpt-5-chat-latest                    # Primary model (GPT-5)
OPENAI_FALLBACK_MODEL=gpt-4o                      # Fallback for rate limits/permissions

# AI Budget Controls
AI_MAX_CALLS_PER_MIN=60
AI_MAX_DAILY_USD=50
AI_CIRCUIT_OPEN_SEC=300
CONF_MIN_EXPORT=0.72                              # Minimum confidence for QuickBooks export

# QuickBooks Online OAuth
QBO_CLIENT_ID=XXXXX
QBO_CLIENT_SECRET=XXXXX
QBO_REDIRECT_URI=https://api.ai-bookkeeper.app/api/auth/qbo/callback

# Xero OAuth
XERO_CLIENT_ID=XXXXX
XERO_CLIENT_SECRET=XXXXX
XERO_REDIRECT_URI=https://api.ai-bookkeeper.app/api/auth/xero/callback

# Redis (optional, for caching)
REDIS_URL=redis://localhost:6379

# Email (for notifications)
SMTP_HOST=smtp.sendgrid.net
SMTP_PORT=587
SMTP_USER=apikey
SMTP_PASSWORD=SG.XXXXX
FROM_EMAIL=noreply@ai-bookkeeper.app

# ============================================================================
# Frontend (Next.js)
# ============================================================================

# API URL
NEXT_PUBLIC_API_URL=https://api.ai-bookkeeper.app
# For local dev: http://localhost:8000

# Base URL (for redirects)
NEXT_PUBLIC_BASE_URL=https://app.ai-bookkeeper.app
# For local dev: http://localhost:3000

# Google Analytics
NEXT_PUBLIC_GA_ID=G-XXXXXXXXXX

# ChatGPT Integration
NEXT_PUBLIC_GPT_DEEPLINK=https://chat.openai.com/g/g-XXXXX

# Demo Video
NEXT_PUBLIC_DEMO_LOOM_URL=https://www.loom.com/share/XXXXX

# ============================================================================
# Deployment (Render)
# ============================================================================

# Python version
PYTHON_VERSION=3.11

# Node version
NODE_VERSION=20

# Build commands (set in Render dashboard)
# Backend: pip install -r requirements.txt && alembic upgrade head
# Frontend: cd frontend && npm install && npm run build

# Start commands (set in Render dashboard)
# Backend: uvicorn app.api.main:app --host 0.0.0.0 --port $PORT
# Frontend: cd frontend && npm start

# ============================================================================
# Development Only
# ============================================================================

# Debug mode
DEBUG=false

# Log level
LOG_LEVEL=INFO

# Disable CSRF for local testing (NEVER in production)
DISABLE_CSRF=false

# ============================================================================
# MVP Phase - New Variables
# ============================================================================

# Stripe Billing Portal
STRIPE_BILLING_PORTAL_RETURN_URL=https://app.ai-bookkeeper.app/firm

# QuickBooks Environment (sandbox or production)
QBO_ENV=sandbox
# For production: QBO_ENV=production

# QuickBooks Sandbox Credentials (separate from production)
QBO_CLIENT_ID_SANDBOX=XXXXX
QBO_CLIENT_SECRET_SANDBOX=XXXXX

# Demo Mode (allows mock exports without real QBO connection)
DEMO_MODE=true
# For production: DEMO_MODE=false

# Database Connection Pooling (for PostgreSQL)
DB_POOL_SIZE=8
DB_MAX_OVERFLOW=16
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600

# App URL (for redirects and callbacks)
APP_URL=https://app.ai-bookkeeper.app
# For local dev: http://localhost:10000

# Request Tracking
# (Request IDs are auto-generated, no config needed)

# PII Redaction
# (Enabled by default in logs, no config needed)

# ============================================================================
# Optional: Background Jobs (Redis Queue)
# ============================================================================
# If not set, uses in-memory queue (suitable for single-instance deployments)
# REDIS_URL=redis://localhost:6379/0

# ============================================================================
# Free Categorizer v1 - Trust & Conversion
# ============================================================================

# SOC2 Status (controls compliance copy in UI)
SOC2_STATUS=aligned
# Options: aligned | in_progress | certified

# Free Tool Limits
FREE_MAX_ROWS=500
FREE_MAX_FILE_MB=10
FREE_MAX_UNZIP_MB=50
FREE_API_CONCURRENCY_PER_IP=2

# Features
NEXT_PUBLIC_ENABLE_EMAIL_GATE=true
NEXT_PUBLIC_ENABLE_ANALYTICS=true
MAINTENANCE_MODE=false

# Rate Limiting (optional - requires Upstash Redis)
UPSTASH_REDIS_REST_URL=
UPSTASH_REDIS_REST_TOKEN=

# Retention
FREE_RETENTION_HOURS=24

# Admin Tokens
ADMIN_PURGE_TOKEN=your-secure-token-minimum-32-characters-change-in-production
ADMIN_VERIFY_TOKEN=your-secure-token-for-deletion-sla-verifier-change-in-production

# Storage Directory for Ephemeral Uploads
FREE_UPLOAD_DIR=/tmp/free_uploads

# IP Hashing Salt (for privacy-preserving IP logging)
IP_HASH_SALT=your-random-salt-change-in-production-minimum-32-characters

# Backend API (for server actions)
BACKEND_API_BASE=https://api.ai-bookkeeper.app
BACKEND_API_KEY=optional-api-key-for-backend-auth


# SEO Configuration  
NEXT_PUBLIC_SITE_URL=https://ai-bookkeeper.app
SITEMAP_URL=https://ai-bookkeeper.app/sitemap.xml
